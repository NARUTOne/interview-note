# P20

> ç®—æ³•é¢˜ æ‰¾å‡ºè¿™ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°

**âš¡é¢˜ç›®**:

â“ ç»™å®šä¸¤ä¸ªå¤§å°ä¸º m å’Œ n çš„æœ‰åºæ•°ç»„ nums1 å’Œ nums2ã€‚è¯·æ‰¾å‡ºè¿™ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°ã€‚è¦æ±‚ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(log(m+n))

ç¤ºä¾‹ 1ï¼š

nums1 = [1, 3]
nums2 = [2]
ä¸­ä½æ•°æ˜¯ 2.0

ç¤ºä¾‹ 2ï¼š

nums1 = [1, 2]
nums2 = [3, 4]
ä¸­ä½æ•°æ˜¯(2 + 3) / 2 = 2.5

## ä¼˜è§£ ğŸ”¥

> ç”±äºæœ‰åºï¼Œé¦–å…ˆconcatæ•°ç»„ï¼Œç„¶ååˆ¤æ–­æ•°ç»„é•¿åº¦æ˜¯å¥‡æ•°å¶æ•°ï¼Œå¥‡æ•°ç›´æ¥æ‰¾ç¬¬n/2ä½ï¼Œå¶æ•°æ‰¾(n/2-1 + n/2)/2

```js
function getMidNum (arr1, arr2) {
  const arr = [].concat(arr1, arr2).sort((a, b) => a-b);
  const len = arr.length;

  let k = [0];
  if (len % 2) {
    k = [Math.floor(len / 2)]
  } else {
    k = [len/2 - 1, len/2];
  }

  const addNum = k.reduce((a, b) => a + arr[b], 0);
  return k.length == 1 ? addNum : addNum / 2;
}
```

> éœ€è¦æ»¡è¶³ æ—¶é—´å¤æ‚åº¦ O(log(m+n))

[leetcode å‚è€ƒè§£æ³•ä¸‰](https://leetcode-cn.com/problems/median-of-two-sorted-arrays/solution/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-by-w-2/)

äºŒåˆ†æ³•ï¼Œæ¯æ¬¡k/2æ’é™¤

```js
/**
 * @param {number[]} nums1
 * @param {number[]} nums2
 * @return {number}
 */
var findMedianSortedArrays = function(nums1, nums2) {
  let m = nums1.length
  let n = nums2.length

  // å¥‡æ•°ï¼Œå¶æ•°
  let k1 = Math.floor((m + n + 1) / 2)
  let k2 = Math.floor((m + n + 2) / 2)

  // ï¼ˆå¥‡ + å¶ï¼‰/ 2 ï¼š ä¸­ä½æ•°æ˜¯ä¸¤ä¸ªæœ‰åºæ•°ç»„ä¸­çš„ç¬¬ (m+n)/2 ä¸ªå…ƒç´ å’Œç¬¬ (m+n)/2+1 ä¸ªå…ƒç´ çš„å¹³å‡å€¼
  return (findMedianSortedArraysCore(nums1, 0, nums2, 0, k1) + findMedianSortedArraysCore(nums1, 0, nums2, 0, k2)) / 2
};

/**
 * åŒæŒ‡é’ˆ
 * ä¸¤æ•°ç»„æ¯”è¾ƒç¡®å®š
 * @param {number[]} nums1 â€”â€”>
 * @param {number[]} nums2 <â€”â€”
 * @param {number} i
 * @param {number} j
 * @param {number} kï¼Œæ­¥è¿›
 * @return {number}
 */
const findMedianSortedArraysCore = (nums1, i, nums2, j, k)  => {
  // å¦‚æœæ•°ç»„èµ·å§‹ä½ç½®å·²ç»å¤§äºæ•°ç»„é•¿åº¦-1
  // è¯´æ˜å·²ç»æ˜¯ä¸ªç©ºæ•°ç»„
  // ç›´æ¥ä»å¦å¤–ä¸€ä¸ªæ•°ç»„é‡Œå–ç¬¬kä¸ªæ•°å³å¯
  if (i > nums1.length - 1) {
    return nums2[j + k - 1]
  }
  if (j > nums2.length - 1) {
    return nums1[i + k - 1]
  }
  // å¦‚æœkä¸º1, å½“å‰å¾ªç¯æ¯”è¾ƒç»“æŸï¼ŒæŸé¡¹æ•°ç»„è¾¾åˆ°æœ€åä¸€é¡¹æˆ–ç¬¬ä¸€é¡¹
  // å°±æ˜¯å–ä¸¤ä¸ªæ•°ç»„çš„èµ·å§‹å€¼é‡Œçš„æœ€å°å€¼
  if (k === 1) {
    return Math.min(nums1[i], nums2[j])
  }

  // k/2 æ’é™¤
  // å–k2ä¸º(k/2)æˆ–è€…æ•°ç»„1çš„é•¿åº¦æˆ–è€…æ•°ç»„2çš„é•¿åº¦çš„æœ€å°å€¼
  // è¿™ä¸€æ­¥å¯ä»¥é¿å…k2å¤§äºæŸä¸ªæ•°ç»„çš„é•¿åº¦ï¼ˆé•¿åº¦ä¸ºä»èµ·å§‹åæ ‡åˆ°ç»“å°¾ï¼‰
  let k2 = Math.floor(k / 2) // å¯¹åŠæ­¥è¿›
  let length1 = nums1.length - i
  let length2 = nums2.length - j
  k2 = Math.min(k2, length1, length2)

  let value1 = nums1[i + k2 - 1]
  let value2 = nums2[j + k2 - 1]

  // æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„çš„èµ·å§‹åæ ‡çš„å€¼
  // å¦‚æœvalue1å°äºvalue2
  // å°±èˆå¼ƒnums1å‰i + k2éƒ¨åˆ†
  // å¦åˆ™èˆå¼ƒnums2å‰j + k2éƒ¨åˆ†
  if (value1 < value2) {
    return findMedianSortedArraysCore(nums1, i + k2, nums2, j, k - k2)
  } else {
    return findMedianSortedArraysCore(nums1, i, nums2, j + k2, k - k2)
  }
}
```

> åˆ†å‰²åï¼Œéœ€è¦ç¡®ä¿å·¦ä¾§çš„å…ƒç´ éƒ½æ¯”å³ä¾§çš„å…ƒç´ å°

nums1åˆ‡å‰²åå·¦ä¾§çš„å…ƒç´ ä¸ªæ•°+nums2åˆ‡å‰²åå·¦ä¾§å…ƒç´ çš„ä¸ªæ•°===ä¸¤ä¸ªæ•°ç»„é•¿åº¦å’Œçš„ä¸€åŠ

L1 <= R1  
L1 <= R2  
L2 <= R1
L2 <= R2  

```js
/**
 * @param {number[]} nums1
 * @param {number[]} nums2
 * @return {number}
 */
const findMedianSortedArrays = function(nums1, nums2) {  
    const len1 = nums1.length  
    const len2 = nums2.length
    // ç¡®ä¿ç›´æ¥å¤„ç†çš„æ•°ç»„ï¼ˆç¬¬ä¸€ä¸ªæ•°ç»„ï¼‰æ€»æ˜¯è¾ƒçŸ­çš„æ•°ç»„
    if(len1 > len2) {
        return findMedianSortedArrays(nums2, nums1)
    }
    // è®¡ç®—ä¸¤ä¸ªæ•°ç»„çš„æ€»é•¿åº¦
    const len = len1 + len2
    // åˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ•°ç»„â€œä¸‹åˆ€â€çš„ä½ç½®
    let slice1 = 0  
    // åˆå§‹åŒ–ç¬¬äºŒä¸ªæ•°ç»„â€œä¸‹åˆ€â€çš„ä½ç½®
    let slice2 = 0  
    // åˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ•°ç»„äºŒåˆ†èŒƒå›´çš„å·¦ç«¯ç‚¹
    let slice1L = 0  
    // åˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ•°ç»„äºŒåˆ†èŒƒå›´çš„å³ç«¯ç‚¹
    let slice1R = len1  
    let L1, L2, R1, R2
    // å½“slice1æ²¡æœ‰è¶Šç•Œæ—¶
    while(slice1 <= len1) {
        // ä»¥äºŒåˆ†åŸåˆ™æ›´æ–°slice1
        slice1 = Math.floor((slice1R - slice1L)/2) + slice1L  
        // ç”¨æ€»é•¿åº¦çš„1/2å‡å»slice1ï¼Œç¡®å®šslice2
        slice2 = Math.floor(len/2) - slice1 // è®¡ç®—L1ã€L2ã€R1ã€R2
        const L1 = (slice1===0)? -Infinity : nums1[slice1-1]
        const L2 = (slice2===0)? -Infinity : nums2[slice2-1]  
        const R1 = (slice1===len1)? Infinity : nums1[slice1]  
        const R2 = (slice2===len2)? Infinity: nums2[slice2]

        // å¤„ç†L1>R2çš„é”™è¯¯æƒ…å†µ
        if(L1 > R2) {
            // å°†slice1Rå·¦ç§»ï¼Œè¿›è€Œä½¿slice1å¯¹åº”çš„å€¼å˜å°
            slice1R = slice1 - 1
        } else if(L2 > R1) {
            // åä¹‹å°†slice1Lå³ç§»ï¼Œè¿›è€Œä½¿slice1å¯¹åº”çš„å€¼å˜å¤§
            slice1L = slice1 + 1
        } else {
            // å¦‚æœå·²ç»ç¬¦åˆå–ä¸­ä½æ•°çš„æ¡ä»¶ï¼ˆL1<R2&&L2<R1)ï¼Œåˆ™ç›´æ¥å–ä¸­ä½æ•°
            if(len % 2 === 0) { // å¶
                const L = L1 > L2 ? L1 : L2  
                const R = R1 < R2 ? R1 : R2
                return  (L + R)/2
            } else { // å¥‡
                const median = (R1 < R2) ? R1 : R2  
                return median
            }
        }

    }
    return -1
};
```
