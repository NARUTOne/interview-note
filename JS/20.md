# P20

> JS é¢è¯•

**âš¡é¢˜ç›®**:

â“ æ•°ç»„ç±»å‹åˆ¤æ–­

## ä¼˜è§£ ğŸ”¥

1ã€**Object.prototype.toString.call()**

æ¯ä¸€ä¸ªç»§æ‰¿ Object çš„å¯¹è±¡éƒ½æœ‰ toString æ–¹æ³•ï¼Œå¦‚æœ toString æ–¹æ³•æ²¡æœ‰é‡å†™çš„è¯ï¼Œä¼šè¿”å› [Object type]ï¼Œå…¶ä¸­ type ä¸ºå¯¹è±¡çš„ç±»å‹ã€‚ä½†å½“é™¤äº† Object ç±»å‹çš„å¯¹è±¡å¤–ï¼Œå…¶ä»–ç±»å‹ç›´æ¥ä½¿ç”¨ toString æ–¹æ³•æ—¶ï¼Œä¼šç›´æ¥è¿”å›éƒ½æ˜¯å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨callæˆ–è€…applyæ–¹æ³•æ¥æ”¹å˜toStringæ–¹æ³•çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚

```js
Object.prototype.toString.call('An') // "[object String]"
Object.prototype.toString.call(1) // "[object Number]"
Object.prototype.toString.call(Symbol(1)) // "[object Symbol]"
Object.prototype.toString.call(null) // "[object Null]"
Object.prototype.toString.call(undefined) // "[object Undefined]"
Object.prototype.toString.call(function(){}) // "[object Function]"
Object.prototype.toString.call({name: 'An'}) // "[object Object]"
```

2ã€**instanceof**

instanceof  çš„å†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»å‹çš„ prototypeã€‚
ä½¿ç”¨ instanceofåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„ï¼Œinstanceof ä¼šåˆ¤æ–­è¿™ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šæ˜¯å¦ä¼šæ‰¾åˆ°å¯¹åº”çš„ Array çš„åŸå‹ï¼Œæ‰¾åˆ°è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚

ä½† instanceof åªèƒ½ç”¨æ¥åˆ¤æ–­å¯¹è±¡ç±»å‹ï¼ŒåŸå§‹ç±»å‹ä¸å¯ä»¥ã€‚å¹¶ä¸”æ‰€æœ‰å¯¹è±¡ç±»å‹ instanceof Object éƒ½æ˜¯ trueã€‚

`[] instanceof Array; // true`

3ã€**Array.isArray**

> ES5æ–°å¢æ–¹æ³•ï¼Œåˆ¤æ–­æ•°ç»„

- nstanceof ä¸ isArray

å½“æ£€æµ‹Arrayå®ä¾‹æ—¶ï¼ŒArray.isArray ä¼˜äº instanceof ï¼Œå› ä¸º Array.isArray å¯ä»¥æ£€æµ‹å‡º iframes

```js
var iframe = document.createElement('iframe');
document.body.appendChild(iframe);
xArray = window.frames[window.frames.length-1].Array;
var arr = new xArray(1,2,3); // [1,2,3]

// Correctly checking for Array
Array.isArray(arr);  // true
Object.prototype.toString.call(arr); // true
// Considered harmful, because doesn't work though iframes
arr instanceof Array; // false
```

- Array.isArray() ä¸ Object.prototype.toString.call()

å…¼å®¹ä½¿ç”¨

```js
if (!Array.isArray) {
  Array.isArray = function(arg) {
    return Object.prototype.toString.call(arg) === '[object Array]';
  };
}
```
